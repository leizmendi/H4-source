CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False






Option Compare Database
Option Explicit
Dim FilasPorPágina As Byte

Private Sub Detalle_Format(Cancel As Integer, FormatCount As Integer)
    If Me.Cantidad = 0 Then
       Me.Cantidad.Visible = False
       Me.PrecioUnitario.Visible = False
       Me.IMPORTE.Visible = False
    Else
       Me!Cantidad.Visible = True
       Me.PrecioUnitario.Visible = True
       Me.IMPORTE.Visible = True
    End If
    
    If (Me!Fila = Me!PáginaPedido * (FilasPorPágina - 1) + 1) And Me!Fila <> Me!CuentaFilas Then
        Me!Continúa.Visible = True
        'Me.SaltoPagina1.Visible = True
    End If

    ' Show page break and hide controls in detail record.
    With Me
        If !Continúa.Visible Then
            
'            !Section(0).ForceNewPage = 2
'            !FechaInicio.Visible = False
'            !FechaFin.Visible = False
            !Dias.Visible = False
            !Cantidad.Visible = False
            !PrecioUnitario.Visible = False
            !Concepto.Visible = False
            !IMPORTE.Visible = False
            ' Increase value in Order Page.
            .NextRecord = False
            !PáginaPedido = Me!PáginaPedido + 1
        Else
            ' Increase row count if detail record is printed.
            !Fila = Me!Fila + 1
        End If
    End With
End Sub



Private Sub EncabezadoDelGrupo0_Format(Cancel As Integer, FormatCount As Integer)
    Me!Fila = 1
    Me!PáginaPedido = 1

    '  Hide Continued and DetailPageBreak controls.
    Me!Continúa.Visible = False
'    CambiaFormatoPtsEuros Me.PtsEuros, Me

End Sub

Private Sub EncabezadoDePágina_Format(Cancel As Integer, FormatCount As Integer)
    '  At top of page, initialize controls in detail section.
    
    '  Set value of Row text box to 0.
    '  Set Visible property to show controls in detail record
    '  and hide Continued and DetailPageBreak controls.
    With Me
        !Fila = 0
        !Continúa.Visible = False
        !SaltoPagina1.Visible = False
'        !FechaInicio.Visible = True
'        !FechaFin.Visible = True
        !Cantidad.Visible = True
        !Concepto.Visible = True
        !Dias.Visible = True
        !PrecioUnitario.Visible = True
        !IMPORTE.Visible = True
    End With
'    If Me![IvaIncluidoDetalle] = True Then
'        Me.lblPrecio.Caption = "Precio(IVA inc.)"
'    Else
'        Me.lblPrecio.Caption = "Precio    (+IVA)"
'    End If
    If Me![EstadoFicha] = 1 Then
        Me.lblEntrada.Caption = "Reserva"
    Else
        Me.lblEntrada.Caption = "Entrada"
    End If
    If DameValorParam("FichasCabecera") = True Then
        Me.txtCabecera.Visible = True
'        Me.CuadroCabecera.Visible = True
    Else
        Me.txtCabecera.Visible = False
'        Me.CuadroCabecera.Visible = False
    End If
End Sub

Private Sub PieDelGrupo1_Format(Cancel As Integer, FormatCount As Integer)
      Me!ImprimirPiePágina = True
End Sub

Private Sub PieDePágina_Format(Cancel As Integer, FormatCount As Integer)
    '  Determine whether to print page footer.
    
    '  Print page footer if all detail records for
    '  current order have been printed.
    If Me!ImprimirPiePágina = True Then
        Me.PrintSection = True
        Me!ImprimirPiePágina = False
    Else
        '  Don't print page footer if all detail records
        '  for current order haven't been printed.
        Me.PrintSection = False
    End If
End Sub

Private Sub Report_NoData(Cancel As Integer)
    MsgBox "No existe Ficha"
    Cancel = True
End Sub


Private Sub Report_Open(Cancel As Integer)
    FilasPorPágina = Nz(DameValorParam("FichasLineasDetalle"), 20)
End Sub
